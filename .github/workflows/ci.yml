name: CI
on: [push]

jobs:
  lint:
    name: ğŸ“ Run Linter
    runs-on: ubuntu-latest
    steps:
      # ğŸ“¥ 1. Checkout Repository
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      # ğŸ— 2. Set Up Node.js
      - name: ğŸ— Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18
          cache: "npm" # âœ… Caches dependencies for faster builds

      # ğŸ“¦ 3. Install Dependencies
      - name: ğŸ“¦ Install Dependencies
        run: npm ci # âœ… Faster & ensures a clean dependency tree

      # ğŸ“ 4. Run Linter
      - name: ğŸ“ Run Linter
        run: npm run lint

  test:
    name: ğŸ§ª Run Tests
    runs-on: ubuntu-latest
    needs: lint # âœ… Runs only if linting succeeds
    env:
      VITE_SUPABASE_URL: ${{ secrets.VITE_SUPABASE_URL }}
      VITE_SUPABASE_ANON_KEY: ${{ secrets.VITE_SUPABASE_ANON_KEY }}

    steps:
      # ğŸ“¥ 1. Checkout Repository
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      # ğŸ— 2. Set Up Node.js
      - name: ğŸ— Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 18
          cache: "npm"

      # ğŸ“¦ 3. Install Dependencies
      - name: ğŸ“¦ Install Dependencies
        run: npm ci

      # ğŸ§ª 4. Run Tests
      - name: ğŸ§ª Run Tests
        run: npm test
